AnsPress||(AnsPress={}),function(a){wpUploaderInit.browse_button="pickfiles",wpUploaderInit.container="ap-upload",wpUploaderInit.init={FilesAdded:function(b,c){var d=!1;a('form[name="answer_form"]').append('<input type="hidden" name="have_attachments" value="true">'),plupload.each(c,function(c){return b.files.length>b.settings.maxfiles?(d||alert(aplang.attached_max),b.removeFile(c),void(d=!0)):(a("#ap-upload").append('<div id="'+c.id+'" class="ap-upload-item"><span class="ap-upload-name">'+c.name+" ("+plupload.formatSize(c.size)+')</span><a href="#" class="apicon-trashcan"></a><div class="ap-progress"></div></div>'),AnsPress.uploader.start(),void a("#"+c.id+" a").one().click(function(d){d.preventDefault();var e=a(this).attr("data-id"),f=JSON.parse(a(this).attr("ap-query"));f.ap_ajax_action="delete_attachment",AnsPress.ajax({data:f,success:function(d){d.success&&(b.removeFile(c),a("#"+c.id).remove(),"undefined"!=typeof tinyMCE&&(tinyMCE.activeEditor.dom.remove(e),tinyMCE.activeEditor.execCommand("mceInsertContent",!1,"")))}})}))})},UploadProgress:function(b,c){a("#"+c.id+" .ap-progress").css("width",c.percent+"%")},FileUploaded:function(b,c,d){var e=AnsPress.ajaxResponse(d.response);if(e.success&&(a("#"+c.id+" a").attr("ap-query",JSON.stringify({attachment_id:e.attachment_id,__nonce:e.delete_nonce})).attr("data-id",e.attachment_id),a("#"+c.id).addClass("done"),e.is_image)){var f='<img src="'+e.attachment_url+'" id="'+e.attachment_id+'" />';"undefined"!=typeof tinyMCE?tinyMCE.activeEditor.execCommand("mceInsertContent",!1,f):jQuery(".wp-editor-area").val(jQuery(".wp-editor-area").val()+f)}e.success||(AnsPress.trigger("snackbar",e),a("#"+c.id).addClass("failed"))},FilesRemoved:function(b,c){plupload.each(c,function(b){a("#ap-upload #"+b.id).remove()})},Error:function(a,b){b.code===-600&&AnsPress.trigger("snackbar",{success:!1,snackbar:{message:aplang.file_size_error}})}},AnsPress.uploader=new plupload.Uploader(wpUploaderInit),AnsPress.uploader.init(),a(".ap-field-description").on("drag dragstart dragenter dragover",function(b){console.log("drag"),a(this).addClass("dragging")}),a(".ap-field-description").on("dragend  dragleave drop",function(b){console.log("drag remove"),a(this).removeClass("dragging")})}(jQuery);