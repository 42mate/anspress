AnsPress||(AnsPress={}),function(a){var b=function(a,b){var c='<img src="'+a+'" id="'+b+'" />';"undefined"!=typeof tinyMCE?tinyMCE.activeEditor.execCommand("mceInsertContent",!1,c):jQuery(".wp-editor-area").val(jQuery(".wp-editor-area").val()+c)};wpUploaderInit.browse_button="pickfiles",wpUploaderInit.container="ap-upload",wpUploaderInit.init={FilesAdded:function(c,d){var e=!1;a('form[name="answer_form"]').append('<input type="hidden" name="have_attachments" value="true">');var f=a("#ap-upload-template").html();plupload.each(d,function(d){if(c.files.length>c.settings.maxfiles)return e||alert(aplang.attached_max),c.removeFile(d),void(e=!0);var g=a(f);g.attr("id",d.id),g.find(".ap-upload-name").text(d.name+" ("+plupload.formatSize(d.size)+")"),a("#ap-upload").append(g),AnsPress.uploader.start(),a("#"+d.id+" a.apicon-trashcan").one().click(function(b){b.preventDefault();var e=a(this).attr("data-id"),f=JSON.parse(a(this).attr("ap-query"));f.ap_ajax_action="delete_attachment",AnsPress.ajax({data:f,success:function(b){b.success&&(c.removeFile(d),a("#"+d.id).remove(),"undefined"!=typeof tinyMCE&&(tinyMCE.activeEditor.dom.remove(e),tinyMCE.activeEditor.execCommand("mceInsertContent",!1,"")))}})}),a("#"+d.id+" a.insert-to-post").click(function(c){c.preventDefault();var d=a(this).parent().attr("ap-uploaded");d&&(d=JSON.parse(d),b(d.url,d.id))})})},UploadProgress:function(b,c){a("#"+c.id+" .ap-progress").css("width",c.percent+"%")},FileUploaded:function(c,d,e){var f=AnsPress.ajaxResponse(e.response);f.success&&(a("#"+d.id+" a").attr("ap-query",JSON.stringify({attachment_id:f.attachment_id,__nonce:f.delete_nonce})).attr("data-id",f.attachment_id),a("#"+d.id).addClass("done"),f.is_image&&(a("#"+d.id).addClass("is-image"),a("#"+d.id).attr("ap-uploaded",JSON.stringify({url:f.attachment_url,id:f.attachment_id})),b(f.attachment_url,f.attachment_id))),f.success||(AnsPress.trigger("snackbar",f),a("#"+d.id).addClass("failed"))},FilesRemoved:function(b,c){plupload.each(c,function(b){a("#ap-upload #"+b.id).remove()})},Error:function(a,b){b.code===-600&&AnsPress.trigger("snackbar",{success:!1,snackbar:{message:aplang.file_size_error}})}},AnsPress.uploader=new plupload.Uploader(wpUploaderInit),AnsPress.uploader.init(),a(".ap-field-description").on("drag dragstart dragenter dragover",function(b){console.log("drag"),a(this).addClass("dragging")}),a(".ap-field-description").on("dragend  dragleave drop",function(b){a(this).removeClass("dragging")})}(jQuery);