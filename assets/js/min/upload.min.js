AnsPress||(AnsPress={}),function(a){wpUploaderInit.browse_button="pickfiles",wpUploaderInit.container="ap-upload",wpUploaderInit.init={FilesAdded:function(b,c){a('form[name="answer_form"]').append('<input type="hidden" name="have_attachments" value="true">'),plupload.each(c,function(c){a("#ap-upload").append('<div id="'+c.id+'" class="ap-upload-item"><span class="ap-upload-name">'+c.name+" ("+plupload.formatSize(c.size)+')</span><a href="#">Remove</a><div class="ap-progress"></div></div>'),AnsPress.uploader.start(),a("#"+c.id+" a").one().click(function(d){d.preventDefault();var e=a(this).attr("data-id"),f=JSON.parse(a(this).attr("ap-query"));f.ap_ajax_action="delete_attachment",AnsPress.ajax({data:f,success:function(d){d.success&&(b.removeFile(c),a("#"+c.id).remove(),"undefined"!=typeof tinyMCE&&(tinyMCE.activeEditor.dom.remove(e),tinyMCE.activeEditor.execCommand("mceInsertContent",!1,"")))}})})})},UploadProgress:function(b,c){a("#"+c.id+" .ap-progress").css("width",c.percent+"%")},FileUploaded:function(b,c,d){var e=AnsPress.ajaxResponse(d.response);if(e.success){a("#"+c.id+" a").attr("ap-query",JSON.stringify({attachment_id:e.attachment_id,__nonce:e.delete_nonce})).attr("data-id",e.attachment_id);var f='<img src="'+e.attachment_url+'" id="'+e.attachment_id+'" />';"undefined"!=typeof tinyMCE?tinyMCE.activeEditor.execCommand("mceInsertContent",!1,f):jQuery(".wp-editor-area").val(jQuery(".wp-editor-area").val()+f)}},FilesRemoved:function(b,c){plupload.each(c,function(b){a("#ap-upload #"+b.id).remove()})}},AnsPress.uploader=new plupload.Uploader(wpUploaderInit),AnsPress.uploader.init()}(jQuery);